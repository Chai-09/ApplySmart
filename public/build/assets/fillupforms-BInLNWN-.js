document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("educational_level"),t=document.getElementById("incoming_grlvl"),o=document.getElementById("birthday-container"),e=document.getElementById("applicant_bday"),l=document.getElementById("lrn-container"),a=document.getElementById("lrn_no"),d=document.getElementById("strand-container"),r=document.getElementById("strand"),i=document.getElementById("grade-level-container");i.style.display="none";const c=document.getElementById("source-container");c.style.display="none";const u={"Grade School":["Kinder","Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],"Junior High School":["Grade 7","Grade 8","Grade 9","Grade 10"],"Senior High School":["Grade 11","Grade 12"]};function m(s){t.innerHTML='<option value="">Select Grade Level</option>',u[s]&&u[s].forEach(p=>{const y=document.createElement("option");y.value=p,y.textContent=p,t.appendChild(y)})}n.addEventListener("change",function(){const s=this.value;m(s),u[s]?(i.style.display="block",c.style.display="block"):(i.style.display="none",c.style.display="none"),o.style.display="none",e.required=!1,e.disabled=!0,e.value="",l.style.display="none",a.required=!1,a.disabled=!0,a.value="",d.style.display="none",r.required=!1,r.disabled=!0,r.value="",(s==="Grade School"||s==="Junior High School")&&(l.style.display="block",a.disabled=!1,a.required=!0),s==="Senior High School"&&(l.style.display="block",a.disabled=!1,a.required=!0,d.style.display="block",r.disabled=!1,r.required=!0)}),t.addEventListener("change",function(){const s=this.value;n.value==="Grade School"&&(s==="Kinder"||s==="Grade 1")?(o.style.display="block",e.disabled=!1,e.required=!0):(o.style.display="none",e.disabled=!0,e.required=!1,e.value="")})});function f(n){const t=document.getElementById("alert-container"),o=document.getElementById("alert-wrapper"),e=document.querySelector(".alert-box");e&&e.remove();const l=document.createElement("div");l.classList.add("alert-box"),l.innerHTML=`
        <div class="alert-content">
            <div class="alert-message">
                <span><i class="fa-solid fa-circle-exclamation"></i> ${n}</span>
            </div>
            <span class="alert-close" onclick="this.parentElement.parentElement.remove()">&times;</span>
        </div>
    `,o.style.display="block",t.style.display="block",t.appendChild(l)}window.nextStep=function(n){if(n>1){const o=document.querySelectorAll(`#step${n-1} [required]`);let e=!0;if(o.forEach(l=>{l.value.trim()?l.classList.remove("border-danger"):(e=!1,l.classList.add("border-danger"))}),!e){f("Please complete all required fields before proceeding.");return}}document.querySelectorAll("#step1, #step2, #step3").forEach(o=>{o.style.display="none"}),document.getElementById("step"+n).style.display="block";const t=document.querySelector(".alert-box");t&&t.remove(),document.querySelectorAll("input, select").forEach(o=>{o.classList.remove("border-danger")})};document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("current_school_city"),t=document.getElementById("citySuggestions");if(!n||!t)return;let o=[];fetch("https://psgc.gitlab.io/api/provinces/").then(e=>e.json()).then(e=>{o=e}).catch(e=>console.error("Failed to load provinces:",e)),n.addEventListener("input",async function(){const e=n.value.trim().toLowerCase();if(t.innerHTML="",!(e.length<2))try{const a=await(await fetch("https://psgc.gitlab.io/api/cities-municipalities/")).json(),d=[];for(const r of a)if(r.name.toLowerCase().includes(e)){let i="Unknown Province";if(!r.provinceCode)i="Metro Manila";else{const c=o.find(u=>u.code===r.provinceCode);c&&(i=c.name)}d.push(`${r.name}, ${i}`)}d.length===0?t.innerHTML='<li class="list-group-item disabled">No results found</li>':d.forEach(r=>{const i=document.createElement("li");i.classList.add("list-group-item"),i.textContent=r,i.style.cursor="pointer",i.onclick=()=>{n.value=r,t.innerHTML=""},t.appendChild(i)})}catch(l){console.error("City fetch error:",l)}}),document.addEventListener("click",e=>{!t.contains(e.target)&&e.target!==n&&(t.innerHTML="")})});
