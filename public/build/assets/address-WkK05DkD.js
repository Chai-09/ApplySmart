document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("region"),a=document.getElementById("province"),i=document.getElementById("city"),s=document.getElementById("barangay"),h=d.getAttribute("data-selected"),g=a.getAttribute("data-selected"),l=i.getAttribute("data-selected"),u=s.getAttribute("data-selected");function o(t,e=null){const n=e||"Choose "+f(t.name);t.innerHTML=`<option value="" disabled selected hidden>${n}</option>`}function f(t){return t.charAt(0).toUpperCase()+t.slice(1)}function r(t,e,n="name",c=null){return fetch(t).then(p=>p.json()).then(p=>{o(e),p.forEach(m=>{const v=m[n],E=c&&v===c?"selected":"";e.innerHTML+=`<option value="${v}" ${E}>${v}</option>`})})}r("https://psgc.gitlab.io/api/regions/",d,"name",h).then(()=>{h&&(d.value=h,d.dispatchEvent(new Event("change")))}),d.addEventListener("change",function(){const t=this.value;o(a),o(i),o(s),fetch("https://psgc.gitlab.io/api/regions/").then(e=>e.json()).then(e=>{const n=e.find(p=>p.name===t);if(!n)return;const c=n.code;c==="130000000"?(a.innerHTML='<option value="Metro Manila (NCR)" selected>Metro Manila (NCR)</option>',r(`https://psgc.gitlab.io/api/regions/${c}/cities-municipalities/`,i,"name",l).then(()=>{l&&(i.value=l,i.dispatchEvent(new Event("change")))})):r(`https://psgc.gitlab.io/api/regions/${c}/provinces/`,a,"name",g).then(()=>{g&&(a.value=g,a.dispatchEvent(new Event("change")))})})}),a.addEventListener("change",function(){const t=this.value;o(i),o(s),t!=="Metro Manila (NCR)"&&fetch("https://psgc.gitlab.io/api/provinces/").then(e=>e.json()).then(e=>{const n=e.find(c=>c.name===t);n&&r(`https://psgc.gitlab.io/api/provinces/${n.code}/cities-municipalities/`,i,"name",l).then(()=>{l&&(i.value=l,i.dispatchEvent(new Event("change")))})})}),i.addEventListener("change",function(){const t=this.value;o(s),fetch("https://psgc.gitlab.io/api/cities-municipalities/").then(e=>e.json()).then(e=>{const n=e.find(c=>c.name===t);n&&r(`https://psgc.gitlab.io/api/cities-municipalities/${n.code}/barangays/`,s,"name",u).then(()=>{u&&(s.value=u)})})})});
